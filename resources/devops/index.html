<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.91.2" />
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/azure-saas/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/azure-saas/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/azure-saas/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/azure-saas/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-192x192.png" sizes="192x192">

<title>DevOps Workflows | Azure SaaS Dev Kit Docs</title>
<meta name="description" content="For your convenience, we have provided some sample GitHub workflows that you can use to build and deploy code changes to each module. These workflows â€¦">
<meta property="og:title" content="DevOps Workflows" />
<meta property="og:description" content="For your convenience, we have provided some sample GitHub workflows that you can use to build and deploy code changes to each module. These workflows are the same ones that we use to package and release the code to our test environment. They were created as a baseline reference with the intent to be extensible when needed.
How does it work? There are 2 reusable workflows we have created which the process is based on." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://azure.github.io/azure-saas/resources/devops/" /><meta property="article:section" content="resources" />

<meta property="article:modified_time" content="2022-06-28T13:52:56-04:00" /><meta property="og:site_name" content="Azure SaaS Dev Kit Docs" />

<meta itemprop="name" content="DevOps Workflows">
<meta itemprop="description" content="For your convenience, we have provided some sample GitHub workflows that you can use to build and deploy code changes to each module. These workflows are the same ones that we use to package and release the code to our test environment. They were created as a baseline reference with the intent to be extensible when needed.
How does it work? There are 2 reusable workflows we have created which the process is based on.">
<meta itemprop="dateModified" content="2022-06-28T13:52:56-04:00" />
<meta itemprop="wordCount" content="772">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="DevOps Workflows"/>
<meta name="twitter:description" content="For your convenience, we have provided some sample GitHub workflows that you can use to build and deploy code changes to each module. These workflows are the same ones that we use to package and release the code to our test environment. They were created as a baseline reference with the intent to be extensible when needed.
How does it work? There are 2 reusable workflows we have created which the process is based on."/>




<link rel="preload" href="/azure-saas/scss/main.min.6f5cd96bf6c17a369ab4138315a3d451055126106103b214d1481bf522d56eb1.css" as="style">
<link href="/azure-saas/scss/main.min.6f5cd96bf6c17a369ab4138315a3d451055126106103b214d1481bf522d56eb1.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>


<script type="text/javascript">
  !function(T,l,y){var S=T.location,k="script",D="connectionString",C="ingestionendpoint",I="disableExceptionTracking",E="ai.device.",b="toLowerCase",w="crossOrigin",N="POST",e="appInsightsSDK",t=y.name||"appInsights";(y.name||T[e])&&(T[e]=t);var n=T[t]||function(d){var g=!1,f=!1,m={initialize:!0,queue:[],sv:"5",version:2,config:d};function v(e,t){var n={},a="Browser";return n[E+"id"]=a[b](),n[E+"type"]=a,n["ai.operation.name"]=S&&S.pathname||"_unknown_",n["ai.internal.sdkVersion"]="javascript:snippet_"+(m.sv||m.version),{time:function(){var e=new Date;function t(e){var t=""+e;return 1===t.length&&(t="0"+t),t}return e.getUTCFullYear()+"-"+t(1+e.getUTCMonth())+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((e.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),name:"Microsoft.ApplicationInsights."+e.replace(/-/g,"")+"."+t,sampleRate:100,tags:n,data:{baseData:{ver:2}}}}var h=d.url||y.src;if(h){function a(e){var t,n,a,i,r,o,s,c,u,p,l;g=!0,m.queue=[],f||(f=!0,t=h,s=function(){var e={},t=d.connectionString;if(t)for(var n=t.split(";"),a=0;a<n.length;a++){var i=n[a].split("=");2===i.length&&(e[i[0][b]()]=i[1])}if(!e[C]){var r=e.endpointsuffix,o=r?e.location:null;e[C]="https://"+(o?o+".":"")+"dc."+(r||"services.visualstudio.com")}return e}(),c=s[D]||d[D]||"",u=s[C],p=u?u+"/v2/track":d.endpointUrl,(l=[]).push((n="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",a=t,i=p,(o=(r=v(c,"Exception")).data).baseType="ExceptionData",o.baseData.exceptions=[{typeName:"SDKLoadFailed",message:n.replace(/\./g,"-"),hasFullStack:!1,stack:n+"\nSnippet failed to load ["+a+"] -- Telemetry is disabled\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\nHost: "+(S&&S.pathname||"_unknown_")+"\nEndpoint: "+i,parsedStack:[]}],r)),l.push(function(e,t,n,a){var i=v(c,"Message"),r=i.data;r.baseType="MessageData";var o=r.baseData;return o.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+n+")").replace(/\"/g,"")+'"',o.properties={endpoint:a},i}(0,0,t,p)),function(e,t){if(JSON){var n=T.fetch;if(n&&!y.useXhr)n(t,{method:N,body:JSON.stringify(e),mode:"cors"});else if(XMLHttpRequest){var a=new XMLHttpRequest;a.open(N,t),a.setRequestHeader("Content-type","application/json"),a.send(JSON.stringify(e))}}}(l,p))}function i(e,t){f||setTimeout(function(){!t&&m.core||a()},500)}var e=function(){var n=l.createElement(k);n.src=h;var e=y[w];return!e&&""!==e||"undefined"==n[w]||(n[w]=e),n.onload=i,n.onerror=a,n.onreadystatechange=function(e,t){"loaded"!==n.readyState&&"complete"!==n.readyState||i(0,t)},n}();y.ld<0?l.getElementsByTagName("head")[0].appendChild(e):setTimeout(function(){l.getElementsByTagName(k)[0].parentNode.appendChild(e)},y.ld||0)}try{m.cookie=l.cookie}catch(p){}function t(e){for(;e.length;)!function(t){m[t]=function(){var e=arguments;g||m.queue.push(function(){m[t].apply(m,e)})}}(e.pop())}var n="track",r="TrackPage",o="TrackEvent";t([n+"Event",n+"PageView",n+"Exception",n+"Trace",n+"DependencyData",n+"Metric",n+"PageViewPerformance","start"+r,"stop"+r,"start"+o,"stop"+o,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),m.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4};var s=(d.extensionConfig||{}).ApplicationInsightsAnalytics||{};if(!0!==d[I]&&!0!==s[I]){var c="onerror";t(["_"+c]);var u=T[c];T[c]=function(e,t,n,a,i){var r=u&&u(e,t,n,a,i);return!0!==r&&m["_"+c]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},d.autoExceptionInstrumented=!0}return m}(y.cfg);function a(){y.onInit&&y.onInit(n)}(T[t]=n).queue&&0===n.queue.length?(n.queue.push(a),n.trackPageView({})):a()}(window,document,{
  src: "https://js.monitor.azure.com/scripts/b/ai.2.min.js", 
  
  
  
  crossOrigin: "anonymous", 
  
  cfg: { 
      connectionString: ""
  }});
  </script>


<script>
  $(() => {
    $(".language-mermaid").wrapInner("<div class=\"mermaid\"></div>");
    mermaid.init();

    
    const svg = $(".mermaid svg");
		svg.removeAttr('height');
  });
</script>


  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/azure-saas/">
		<span class="navbar-logo"></span><span class="font-weight-bold">Azure SaaS Dev Kit Docs</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/azure-saas/#" ><span>Homepage</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/Azure/azure-saas" target="_blank" ><span>GitHub</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"></div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-azure-saas-li">
  <a href="/azure-saas/" title="" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-azure-saas"><span class="">Introduction</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasquick-start-li">
  <a href="/azure-saas/quick-start/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasquick-start"><span class="">Quick Start</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasdiagrams-li">
  <a href="/azure-saas/diagrams/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasdiagrams"><span class="">Architecture Diagrams</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-azure-saascomponents-li">
  <a href="/azure-saas/components/" title="Azure SaaS Dev Kit Components" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-azure-saascomponents"><span class="">Components</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-azure-saascomponentsidentity-li">
  <a href="/azure-saas/components/identity/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-azure-saascomponentsidentity"><span class="">Identity Framework</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsidentityidentity-provider-li">
  <a href="/azure-saas/components/identity/identity-provider/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsidentityidentity-provider"><span class="">Identity Provider</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsidentitypermissions-service-li">
  <a href="/azure-saas/components/identity/permissions-service/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsidentitypermissions-service"><span class="">SaaS.Permissions.Service</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsidentityidentity-flows-li">
  <a href="/azure-saas/components/identity/identity-flows/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsidentityidentity-flows"><span class="">Identity Flows</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsidentitycaveats-li">
  <a href="/azure-saas/components/identity/caveats/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsidentitycaveats"><span class="">Caveats &amp; Limitations</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsadmin-service-li">
  <a href="/azure-saas/components/admin-service/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsadmin-service"><span class="">SaaS.Admin.Service</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentssignup-administration-li">
  <a href="/azure-saas/components/signup-administration/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentssignup-administration"><span class="">SaaS.SignupAdministration.Web</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentssaas-application-li">
  <a href="/azure-saas/components/saas-application/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentssaas-application"><span class="">SaaS.Application.Web</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentssaas-notifications-li">
  <a href="/azure-saas/components/saas-notifications/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentssaas-notifications"><span class="">SaaS.Notifications</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-azure-saasresources-li">
  <a href="/azure-saas/resources/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-azure-saasresources"><span class="">Resources</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcesbranding-considerations-for-saas-li">
  <a href="/azure-saas/resources/branding-considerations-for-saas/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcesbranding-considerations-for-saas"><span class="">SaaS Branding Considerations</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcescontoso-badgemeup-li">
  <a href="/azure-saas/resources/contoso-badgemeup/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcescontoso-badgemeup"><span class="">Contoso BadgeMeUp</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcesterminology-li">
  <a href="/azure-saas/resources/terminology/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcesterminology"><span class="">Terminology</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcesadditional-recommended-resources-li">
  <a href="/azure-saas/resources/additional-recommended-resources/" title="Azure Recommended Resources" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcesadditional-recommended-resources"><span class="">Additional Recommended Resources</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcescontainer-publishing-li">
  <a href="/azure-saas/resources/container-publishing/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcescontainer-publishing"><span class="">Container Publishing</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href="https://github.com/Azure/azure-saas/tree/main/docs/azure-saas-docs/content/en/resources/devops.md" class="td-page-meta--view" target="_blank" rel="noopener"><i class="fa fa-file-alt fa-fw"></i> View page source</a>
  <a href="https://github.com/Azure/azure-saas/edit/main/docs/azure-saas-docs/content/en/resources/devops.md" class="td-page-meta--edit" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
  <a href="https://github.com/Azure/azure-saas/new/main/docs/azure-saas-docs/content/en/resources/devops.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Create child page</a>
  <a href="https://github.com/Azure/azure-saas/issues/new?title=DevOps%20Workflows" class="td-page-meta--issue" target="_blank" rel="noopener"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
  
</div>

            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#how-does-it-work">How does it work?</a>
      <ul>
        <li><a href="#process-outline">Process Outline</a></li>
        <li><a href="#build--deploy-to-staging"><strong>Build &amp; Deploy to Staging</strong></a></li>
        <li><a href="#swap-staging-slot-into-production"><strong>Swap Staging Slot into Production</strong></a></li>
      </ul>
    </li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="https://azure.github.io/azure-saas/resources/">Resources</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="https://azure.github.io/azure-saas/resources/devops/">DevOps Workflows</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>DevOps Workflows</h1>
	
	<header class="article-meta">
		

  
    


  
    


  

		
	</header>    
	<p>For your convenience, we have provided some sample GitHub workflows that you can use to build and deploy code changes to each module. These workflows are the same ones that we use to package and release the code to our test environment. They were created as a baseline reference with the intent to be extensible when needed.</p>
<h2 id="how-does-it-work">How does it work?</h2>
<p>There are 2 <a href="https://docs.github.com/en/actions/using-workflows/reusing-workflows">reusable workflows</a> we have created which the process is based on.</p>
<p>Each module has 2 workflow files that implement these re-usable workflows ensuring each build and deploy step taken is consistent across the entire solution. Each module workflow file is responsible for defining when the workflow is triggered, setting up variables, and calling the correct reusable workflow.</p>
<h3 id="process-outline">Process Outline</h3>
<h3 id="build--deploy-to-staging"><strong>Build &amp; Deploy to Staging</strong></h3>
<p>Workflow File: <code>template-pr-deploy.yml</code></p>
<ul>
<li><code>pr-deploy-saas-admin.yml</code></li>
<li><code>pr-deploy-saas-application.yml</code></li>
<li><code>pr-deploy-saas-permissions.yml</code></li>
<li><code>pr-deploy-saas-signupadministration.yml</code></li>
</ul>
<p>Triggered On: <code>Pull Request targeting main branch</code></p>
<h4 id="input-variables">Input Variables</h4>
<table>
<thead>
<tr>
<th>Input Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>dotnet_version</td>
<td>The version of the .NET project to build</td>
<td></td>
</tr>
<tr>
<td>artifact_name</td>
<td>The name of the artifact file produced</td>
<td></td>
</tr>
<tr>
<td>app_service_name</td>
<td>The name of the app service to deploy the artifact to</td>
<td></td>
</tr>
<tr>
<td>app_service_resource_group_name</td>
<td>The name of the resource group the app service resides in</td>
<td></td>
</tr>
<tr>
<td>project_build_path</td>
<td>The path of the folder that the .csproj for the module is in</td>
<td></td>
</tr>
<tr>
<td>slot_name</td>
<td>The name of the deployment slot  to create and deploy to on the app service (Used for override, recommended to keep the default)</td>
<td>pr-${{github.event.pull_request.number}}</td>
</tr>
</tbody>
</table>
<h4 id="secrets">Secrets</h4>
<ul>
<li><code>AZURE_CREDENTIALS</code>
<ul>
<li>The CI/CD pipeline must contain Azure credentials for a service principal that has an appropriate access level to create a new Azure App Service slot and deploy to it. See <a href="https://docs.microsoft.com/azure/developer/github/connect-from-azure?tabs=azure-portal%2Cwindows">this</a> document for setting up these credentials in your own repo.</li>
</ul>
</li>
</ul>
<h4 id="job-breakdown">Job Breakdown</h4>
<p>There are 3 jobs within this workflow: <code>build</code>, <code>create-deployment-slot</code>, and <code>deploy-to-slot</code>. Here is a high level overview of what each job does.</p>
<ol>
<li>
<p><code>build</code></p>
<ol>
<li>Run the .NET restore, build, and publish commands on the project. Project is determined by the <code>project_build_path</code> input variable.</li>
<li>Publishes built .NET artifact to GitHub artifacts. Artifact is named with the string provided in the <code>artifact_name</code> input variable.</li>
</ol>
</li>
<li>
<p><code>create-deployment-slot</code></p>
<ol>
<li>Logs into the Azure CLI with <a href="https://docs.microsoft.com/en-us/azure/developer/github/connect-from-azure?tabs=azure-portal%2Cwindows#create-a-service-principal-and-add-it-as-a-github-secret">credentials provided</a> in the <code>AZURE_CREDENTIALS</code> secret.</li>
<li>Runs Azure CLI command to create a new deployment slot in the Azure App Service provided in the <code>app_service_name</code> input variable. Slot name is provided via the <code>slot_name</code> input variable.</li>
</ol>
</li>
<li>
<p><code>deploy-to-slot</code>
Depends on the <code>build</code> and <code>create-deployment-slot</code> jobs to succeed in order to run.</p>
<ol>
<li>Downloads the build artifact from the <code>build</code> job. Downloaded artifact name is provided via the <code>artifact_name</code> input variable.</li>
<li>Logs into the Azure CLI with <a href="https://docs.microsoft.com/en-us/azure/developer/github/connect-from-azure?tabs=azure-portal%2Cwindows#create-a-service-principal-and-add-it-as-a-github-secret">credentials provided</a> in the <code>AZURE_CREDENTIALS</code> secret.</li>
<li>Initiates deployment of the downloaded artifact to the app service and slot specified in <code>app_service_name</code> and <code>slot_name</code> respectively using the <a href="https://github.com/Azure/webapps-deploy">azure/webapps-deploy</a> GitHub Action.</li>
</ol>
</li>
</ol>
<h3 id="swap-staging-slot-into-production"><strong>Swap Staging Slot into Production</strong></h3>
<p>Workflow File: <code>template-pr-merge.yml</code></p>
<p>Used By:</p>
<ul>
<li><code>pr-merge-saas-admin.yml</code></li>
<li><code>pr-merge-saas-application.yml</code></li>
<li><code>pr-merge-saas-permissions.yml</code></li>
<li><code>pr-merge-saas-signupadministration.yml</code></li>
</ul>
<p>Triggered On: <code>Pull request close</code></p>
<h4 id="input-variables-1">Input Variables</h4>
<table>
<thead>
<tr>
<th>Input Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_service_name</td>
<td>The name of the app service the slot is deployed to</td>
<td></td>
</tr>
<tr>
<td>app_service_resource_group_name</td>
<td>The name of the resource group the app service resides in</td>
<td></td>
</tr>
<tr>
<td>slot_name</td>
<td>The name of the deployment slot the staged code is deployed to (Used for override, recommended to keep the default)</td>
<td>pr-${{github.event.pull_request.number}}</td>
</tr>
</tbody>
</table>
<h4 id="secrets-1">Secrets</h4>
<ul>
<li><code>AZURE_CREDENTIALS</code>
<ul>
<li>The CI/CD pipeline must contain Azure credentials for a service principal that has an appropriate access level to perform the swap operation on the Azure App Service in question. See <a href="https://docs.microsoft.com/en-us/azure/developer/github/connect-from-azure?tabs=azure-portal%2Cwindows">this</a> document for setting up these credentials in your own repo.</li>
</ul>
</li>
</ul>
<h4 id="job-breakdown-1">Job Breakdown</h4>
<p>There are 2 main jobs within this workflow: <code>swap-slot</code> and <code>delete-slot</code></p>
<ol>
<li>
<p><code>swap-slot</code> - <em>This job only runs if the PR is closed AND merged. This job does not run if the PR is closed without merging.</em></p>
<ol>
<li>Logs into the Azure CLI with <a href="https://docs.microsoft.com/en-us/azure/developer/github/connect-from-azure?tabs=azure-portal%2Cwindows#create-a-service-principal-and-add-it-as-a-github-secret">credentials provided</a> in the <code>AZURE_CREDENTIALS</code> secret.</li>
<li>Runs the Azure CLI command to swap the deployment slot named in the <code>slot_name</code> input variable with the production slot on the Azure App Service named in the <code>app_service_name</code> input variable.</li>
</ol>
</li>
<li>
<p><code>delete-slot</code> - This job will only run if the preceding step runs and succeeds. If the PR is closed without merging, the previous step will be skipped but this will still run.</p>
<ol>
<li>Logs into the Azure CLI with <a href="https://docs.microsoft.com/en-us/azure/developer/github/connect-from-azure?tabs=azure-portal%2Cwindows#create-a-service-principal-and-add-it-as-a-github-secret">credentials provided</a> in the <code>AZURE_CREDENTIALS</code> secret.</li>
<li>Runs the Azure CLI command to delete the deployment slot named in the <code>slot_name</code> input variable with the production slot on the Azure App Service named in the <code>app_service_name</code> input variable.</li>
</ol>
</li>
</ol>
<blockquote>
<p><strong>Important</strong>: You may choose to not delete the deployment slot directly following a deployment to retain the ability to swap the slot back if there are any issues and you&rsquo;d like to undo the deployment. Deleting the slot immediately after a deployment is most recommended in a development/test environment where you may be deploying multiple times per day.</p>
</blockquote>

	
	
	<div class="text-muted mt-5 pt-3 border-top">
  Last modified June 28, 2022: <a href="https://github.com/Azure/azure-saas/commit/edf2a87e86dc83616fd78fd4ab3f46a9da13ac5c">spelling fixes (edf2a87)</a>
</div>

</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/azure-saas/js/tabpane-persist.js'></script>


















<script src="/azure-saas/js/main.min.6cc4f2e68c1bae5b137f756ede53aa026afaae43271828491e233d4350630be1.js" integrity="sha256-bMTy5owbrlsTf3Vu3lOqAmr6rkMnGChJHiM9Q1BjC&#43;E=" crossorigin="anonymous"></script>




  </body>
</html>