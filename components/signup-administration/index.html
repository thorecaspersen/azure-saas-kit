<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.91.2" />
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/azure-saas/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/azure-saas/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/azure-saas/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/azure-saas/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/azure-saas/favicons/android-192x192.png" sizes="192x192">

<title>SaaS.SignupAdministration.Web | Azure SaaS Dev Kit Docs</title>
<meta name="description" content="Overview
The SaaS.SignupAdministration.Web (aka SignupAdmin) module is a web application meant to faciliate self service onboarding to your SaaS â€¦">
<meta property="og:title" content="SaaS.SignupAdministration.Web" />
<meta property="og:description" content="Overview The SaaS.SignupAdministration.Web (aka SignupAdmin) module is a web application meant to faciliate self service onboarding to your SaaS product. End Users/Customers can visit this site to:
  Sign up for an account
  Go through an onboarding flow to create a new tenant
  Manage their existing tenants.
  This site also supports administrative functionality for global administrators to view and manage all tenants and users of the application." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://azure.github.io/azure-saas/components/signup-administration/" /><meta property="article:section" content="components" />

<meta property="article:modified_time" content="2022-05-24T09:50:08-05:00" /><meta property="og:site_name" content="Azure SaaS Dev Kit Docs" />

<meta itemprop="name" content="SaaS.SignupAdministration.Web">
<meta itemprop="description" content="Overview The SaaS.SignupAdministration.Web (aka SignupAdmin) module is a web application meant to faciliate self service onboarding to your SaaS product. End Users/Customers can visit this site to:
  Sign up for an account
  Go through an onboarding flow to create a new tenant
  Manage their existing tenants.
  This site also supports administrative functionality for global administrators to view and manage all tenants and users of the application.">
<meta itemprop="dateModified" content="2022-05-24T09:50:08-05:00" />
<meta itemprop="wordCount" content="1210">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SaaS.SignupAdministration.Web"/>
<meta name="twitter:description" content="Overview The SaaS.SignupAdministration.Web (aka SignupAdmin) module is a web application meant to faciliate self service onboarding to your SaaS product. End Users/Customers can visit this site to:
  Sign up for an account
  Go through an onboarding flow to create a new tenant
  Manage their existing tenants.
  This site also supports administrative functionality for global administrators to view and manage all tenants and users of the application."/>




<link rel="preload" href="/azure-saas/scss/main.min.6f5cd96bf6c17a369ab4138315a3d451055126106103b214d1481bf522d56eb1.css" as="style">
<link href="/azure-saas/scss/main.min.6f5cd96bf6c17a369ab4138315a3d451055126106103b214d1481bf522d56eb1.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>


<script type="text/javascript">
  !function(T,l,y){var S=T.location,k="script",D="connectionString",C="ingestionendpoint",I="disableExceptionTracking",E="ai.device.",b="toLowerCase",w="crossOrigin",N="POST",e="appInsightsSDK",t=y.name||"appInsights";(y.name||T[e])&&(T[e]=t);var n=T[t]||function(d){var g=!1,f=!1,m={initialize:!0,queue:[],sv:"5",version:2,config:d};function v(e,t){var n={},a="Browser";return n[E+"id"]=a[b](),n[E+"type"]=a,n["ai.operation.name"]=S&&S.pathname||"_unknown_",n["ai.internal.sdkVersion"]="javascript:snippet_"+(m.sv||m.version),{time:function(){var e=new Date;function t(e){var t=""+e;return 1===t.length&&(t="0"+t),t}return e.getUTCFullYear()+"-"+t(1+e.getUTCMonth())+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((e.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),name:"Microsoft.ApplicationInsights."+e.replace(/-/g,"")+"."+t,sampleRate:100,tags:n,data:{baseData:{ver:2}}}}var h=d.url||y.src;if(h){function a(e){var t,n,a,i,r,o,s,c,u,p,l;g=!0,m.queue=[],f||(f=!0,t=h,s=function(){var e={},t=d.connectionString;if(t)for(var n=t.split(";"),a=0;a<n.length;a++){var i=n[a].split("=");2===i.length&&(e[i[0][b]()]=i[1])}if(!e[C]){var r=e.endpointsuffix,o=r?e.location:null;e[C]="https://"+(o?o+".":"")+"dc."+(r||"services.visualstudio.com")}return e}(),c=s[D]||d[D]||"",u=s[C],p=u?u+"/v2/track":d.endpointUrl,(l=[]).push((n="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",a=t,i=p,(o=(r=v(c,"Exception")).data).baseType="ExceptionData",o.baseData.exceptions=[{typeName:"SDKLoadFailed",message:n.replace(/\./g,"-"),hasFullStack:!1,stack:n+"\nSnippet failed to load ["+a+"] -- Telemetry is disabled\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\nHost: "+(S&&S.pathname||"_unknown_")+"\nEndpoint: "+i,parsedStack:[]}],r)),l.push(function(e,t,n,a){var i=v(c,"Message"),r=i.data;r.baseType="MessageData";var o=r.baseData;return o.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+n+")").replace(/\"/g,"")+'"',o.properties={endpoint:a},i}(0,0,t,p)),function(e,t){if(JSON){var n=T.fetch;if(n&&!y.useXhr)n(t,{method:N,body:JSON.stringify(e),mode:"cors"});else if(XMLHttpRequest){var a=new XMLHttpRequest;a.open(N,t),a.setRequestHeader("Content-type","application/json"),a.send(JSON.stringify(e))}}}(l,p))}function i(e,t){f||setTimeout(function(){!t&&m.core||a()},500)}var e=function(){var n=l.createElement(k);n.src=h;var e=y[w];return!e&&""!==e||"undefined"==n[w]||(n[w]=e),n.onload=i,n.onerror=a,n.onreadystatechange=function(e,t){"loaded"!==n.readyState&&"complete"!==n.readyState||i(0,t)},n}();y.ld<0?l.getElementsByTagName("head")[0].appendChild(e):setTimeout(function(){l.getElementsByTagName(k)[0].parentNode.appendChild(e)},y.ld||0)}try{m.cookie=l.cookie}catch(p){}function t(e){for(;e.length;)!function(t){m[t]=function(){var e=arguments;g||m.queue.push(function(){m[t].apply(m,e)})}}(e.pop())}var n="track",r="TrackPage",o="TrackEvent";t([n+"Event",n+"PageView",n+"Exception",n+"Trace",n+"DependencyData",n+"Metric",n+"PageViewPerformance","start"+r,"stop"+r,"start"+o,"stop"+o,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),m.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4};var s=(d.extensionConfig||{}).ApplicationInsightsAnalytics||{};if(!0!==d[I]&&!0!==s[I]){var c="onerror";t(["_"+c]);var u=T[c];T[c]=function(e,t,n,a,i){var r=u&&u(e,t,n,a,i);return!0!==r&&m["_"+c]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},d.autoExceptionInstrumented=!0}return m}(y.cfg);function a(){y.onInit&&y.onInit(n)}(T[t]=n).queue&&0===n.queue.length?(n.queue.push(a),n.trackPageView({})):a()}(window,document,{
  src: "https://js.monitor.azure.com/scripts/b/ai.2.min.js", 
  
  
  
  crossOrigin: "anonymous", 
  
  cfg: { 
      connectionString: ""
  }});
  </script>


<script>
  $(() => {
    $(".language-mermaid").wrapInner("<div class=\"mermaid\"></div>");
    mermaid.init();

    
    const svg = $(".mermaid svg");
		svg.removeAttr('height');
  });
</script>


  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/azure-saas/">
		<span class="navbar-logo"></span><span class="font-weight-bold">Azure SaaS Dev Kit Docs</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/azure-saas/#" ><span>Homepage</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/Azure/azure-saas" target="_blank" ><span>GitHub</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"></div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-azure-saas-li">
  <a href="/azure-saas/" title="" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-azure-saas"><span class="">Introduction</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasquick-start-li">
  <a href="/azure-saas/quick-start/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasquick-start"><span class="">Quick Start</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasdiagrams-li">
  <a href="/azure-saas/diagrams/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasdiagrams"><span class="">Architecture Diagrams</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-azure-saascomponents-li">
  <a href="/azure-saas/components/" title="Azure SaaS Dev Kit Components" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-azure-saascomponents"><span class="">Components</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-azure-saascomponentsidentity-li">
  <a href="/azure-saas/components/identity/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-azure-saascomponentsidentity"><span class="">Identity Framework</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsidentityidentity-provider-li">
  <a href="/azure-saas/components/identity/identity-provider/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsidentityidentity-provider"><span class="">Identity Provider</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsidentitypermissions-service-li">
  <a href="/azure-saas/components/identity/permissions-service/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsidentitypermissions-service"><span class="">SaaS.Permissions.Service</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsidentityidentity-flows-li">
  <a href="/azure-saas/components/identity/identity-flows/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsidentityidentity-flows"><span class="">Identity Flows</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsidentitycaveats-li">
  <a href="/azure-saas/components/identity/caveats/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsidentitycaveats"><span class="">Caveats &amp; Limitations</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentsadmin-service-li">
  <a href="/azure-saas/components/admin-service/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentsadmin-service"><span class="">SaaS.Admin.Service</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-azure-saascomponentssignup-administration-li">
  <a href="/azure-saas/components/signup-administration/" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentssignup-administration"><span class="td-sidebar-nav-active-item">SaaS.SignupAdministration.Web</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentssaas-application-li">
  <a href="/azure-saas/components/saas-application/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentssaas-application"><span class="">SaaS.Application.Web</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saascomponentssaas-notifications-li">
  <a href="/azure-saas/components/saas-notifications/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saascomponentssaas-notifications"><span class="">SaaS.Notifications</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-azure-saasresources-li">
  <a href="/azure-saas/resources/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-azure-saasresources"><span class="">Resources</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcesbranding-considerations-for-saas-li">
  <a href="/azure-saas/resources/branding-considerations-for-saas/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcesbranding-considerations-for-saas"><span class="">SaaS Branding Considerations</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcescontoso-badgemeup-li">
  <a href="/azure-saas/resources/contoso-badgemeup/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcescontoso-badgemeup"><span class="">Contoso BadgeMeUp</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcesterminology-li">
  <a href="/azure-saas/resources/terminology/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcesterminology"><span class="">Terminology</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcesadditional-recommended-resources-li">
  <a href="/azure-saas/resources/additional-recommended-resources/" title="Azure Recommended Resources" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcesadditional-recommended-resources"><span class="">Additional Recommended Resources</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-azure-saasresourcescontainer-publishing-li">
  <a href="/azure-saas/resources/container-publishing/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-azure-saasresourcescontainer-publishing"><span class="">Container Publishing</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href="https://github.com/Azure/azure-saas/tree/main/docs/azure-saas-docs/content/en/components/signup-administration.md" class="td-page-meta--view" target="_blank" rel="noopener"><i class="fa fa-file-alt fa-fw"></i> View page source</a>
  <a href="https://github.com/Azure/azure-saas/edit/main/docs/azure-saas-docs/content/en/components/signup-administration.md" class="td-page-meta--edit" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
  <a href="https://github.com/Azure/azure-saas/new/main/docs/azure-saas-docs/content/en/components/signup-administration.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Create child page</a>
  <a href="https://github.com/Azure/azure-saas/issues/new?title=SaaS.SignupAdministration.Web" class="td-page-meta--issue" target="_blank" rel="noopener"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
  
</div>

            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#how-to-run-locally">How to Run Locally</a>
      <ul>
        <li><a href="#configuration-and-secrets">Configuration and Secrets</a></li>
      </ul>
    </li>
    <li><a href="#module-design">Module Design</a>
      <ul>
        <li><a href="#dependencies">Dependencies</a></li>
        <li><a href="#consumers">Consumers</a></li>
        <li><a href="#authentication">Authentication</a></li>
        <li><a href="#nswag">NSwag</a></li>
        <li><a href="#transactional-emails">Transactional Emails</a></li>
      </ul>
    </li>
    <li><a href="#faq-and-design-considerations">FAQ and Design Considerations</a></li>
    <li><a href="#signup-administration-user-flows">Signup Administration User Flows</a>
      <ul>
        <li><a href="#sign-in">Sign In</a></li>
        <li><a href="#onboarding-flow">Onboarding Flow</a></li>
        <li><a href="#add-new-tenant-admin---existing-user">Add New Tenant Admin - Existing User</a></li>
        <li><a href="#add-new-tenant-admin---user-does-not-exist">Add New Tenant Admin - User Does Not Exist</a></li>
      </ul>
    </li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="https://azure.github.io/azure-saas/components/">Components</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="https://azure.github.io/azure-saas/components/signup-administration/">SaaS.SignupAdministration.Web</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>SaaS.SignupAdministration.Web</h1>
	
	<header class="article-meta">
		

  
    


  
    


  

		
	</header>    
	<h2 id="overview">Overview</h2>
<p>The <a href="https://github.com/Azure/azure-saas/tree/main/src/Saas.SignupAdministration">SaaS.SignupAdministration.Web</a> (aka SignupAdmin) module is a web application meant to faciliate self service onboarding to your SaaS product. End Users/Customers can visit this site to:</p>
<ul>
<li>
<p>Sign up for an account</p>
</li>
<li>
<p>Go through an onboarding flow to create a new tenant</p>
</li>
<li>
<p>Manage their existing tenants.</p>
</li>
</ul>
<p>This site also supports administrative functionality for global administrators to view and manage all tenants and users of the application.</p>
<h2 id="how-to-run-locally">How to Run Locally</h2>
<p>Instructions to get this module running on your local dev machine are located in the module&rsquo;s <a href="https://github.com/Azure/azure-saas/tree/main/src/Saas.SignupAdministration">readme.md</a>.</p>
<h3 id="configuration-and-secrets">Configuration and Secrets</h3>
<p>A list of app settings and secrets can be found in the module&rsquo;s <a href="https://github.com/Azure/azure-saas/tree/main/src/Saas.Identity/Saas.Permissions">readme.md</a>. All non-secret values will have a default value in the <code>appsettings.json</code> file. All secret values will need to be set using the <a href="https://docs.microsoft.com/en-us/aspnet/core/security/app-secrets?view=aspnetcore-6.0&amp;tabs=windows">.NET Secrets Manager</a> when running the module locally, as it is not recommended to have these secret values in your <code>appsettings.json</code> file.</p>
<p>When deployed to Azure, the application is configured to load in its secrets from <a href="https://docs.microsoft.com/azure/key-vault/general/overview">Azure Key Vault</a> instead. If you deploy the project using our ARM/Bicep templates from the Quick Start guide, the modules will be deployed to an app service which accesses the Azure Key Vault using a <a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview">System Assigned Managed Identity</a>. The SignupAdmin module is also configured with <a href="https://docs.microsoft.com/en-us/aspnet/core/security/key-vault-configuration?view=aspnetcore-6.0#use-a-key-name-prefix">key name prefixes</a> to only import secrets with the prefix of <code>signupadmin-</code>, as other modules share the same Azure Key Vault.</p>
<h2 id="module-design">Module Design</h2>
<h3 id="dependencies">Dependencies</h3>
<ul>
<li><a href="../admin-service">SaaS.Admin.Service</a>
<ul>
<li>Depends on the SaaS.Admin.Service for CRUD operations on tenant records, as well as to broker the connection to the SaaS.Permissions.Service for CRUD operations on permissions records.</li>
</ul>
</li>
<li><a href="../identity/identity-provider">Identity Provider</a>
<ul>
<li>Depends on the identity provider to authenticate users and receive a JWT token.</li>
</ul>
</li>
<li><a href="../saas-notifications">SaaS.Notifications</a>
<ul>
<li>Depends on the SaaS.Notifications logic app to send transactional emails to users</li>
</ul>
</li>
</ul>
<h3 id="consumers">Consumers</h3>
<ul>
<li>End Users/Customers</li>
</ul>
<h3 id="authentication">Authentication</h3>
<p>The SignupAdmin site uses the <a href="https://docs.microsoft.com/azure/active-directory/develop/msal-overview">Microsoft Authentication Library (MSAL)</a> to handle the <a href="../identity/identity-flows#sign-in">flow</a> of signing in and parsing the user token from the Azure AD B2C. The identity provider must be configured properly for this to work, and you must provide certain configuration values to the SignupAdmin site for it to properly communicate with Azure AD B2C. These config values can be found in the module&rsquo;s <a href="https://github.com/Azure/azure-saas/tree/main/src/Saas.SignupAdministration">readme.md</a>.</p>
<p>For communication with the SaaS.Admin.Service, the SignupAdmin site also uses the MSAL to request an access token, using the signed-in user&rsquo;s existing token, to use in the Authorization header of all requests. This new token is specific to the SaaS.Admin.Service and will be requested from the Identity Provider with a specific scope. This type of exchange is known as an <a href="https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow">OAuth 2.0 On-Behalf-Of Flow</a>.</p>
<h3 id="nswag">NSwag</h3>
<p>The NSwag project provides tools to generate OpenAPI specifications from existing ASP.NET Web API controllers and client code from these OpenAPI specifications. This provides us a ready-to-use HTTP client without having to write much boilerplate. Read more about <a href="https://docs.microsoft.com/en-us/aspnet/core/tutorials/getting-started-with-nswag?view=aspnetcore-6.0&amp;tabs=visual-studio">using NSwag on ASP.NET projects</a>.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h3 id="transactional-emails">Transactional Emails</h3>
<p>When a new tenant is created, the SignupAdmin site will make a REST call to the <a href="../saas-notifications">SaaS.Notifications</a> module. This module is an <a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-overview">Azure Logic App</a> that gets deployed with a basic endpoint that accepts an email request. You must configure your email provider in this logic app post deployment before emails will actually send from the SignupAdmin site.</p>
<h2 id="faq-and-design-considerations">FAQ and Design Considerations</h2>
<ul>
<li>
<p>For the onboarding workflow, we are keeping track of the state in memory. This is fine for demo purposes and low traffic systems, but this is not a great pattern when introducing horizontally scaled backends. It is recommended that you replace the JsonPersistenceProvider (the service that stores the state) with another implementation backed by an external cache (ex: Redis, CosmosDB, etc). Instructions on where to do this can be found in the module&rsquo;s <a href="https://github.com/Azure/azure-saas/tree/main/src/Saas.SignupAdministration">readme.md</a></p>
</li>
<li>
<p>Q: How do I manage tenants created by this application?</p>
<ul>
<li>A: For ease of management, we have chosen to incorporate the global administrative functionality into this application. You may choose to separate this functionality into a different module if you require more administrative functionality than just tenant and user management</li>
</ul>
</li>
<li>
<p>Q: What other implementation options exist for email notifications?</p>
<ul>
<li>A: A better solution for sending transactional emails might be to emit an event or message from the application, and building a notifications system to subscribe to those events. You could then build other applications to consume those events for other business functions as well. This style of architecture is called an <a href="https://docs.microsoft.com/en-us/azure/architecture/guide/architecture-styles/event-driven">Event Driven</a> architecture. We decided to not go this route (yet!) with this project to keep it simple, but it is something to be considered when looking at your overall technical landscape.</li>
</ul>
</li>
<li>
<p>Q: Why did we choose to not give the signup admin api its own Azure Key Vault?</p>
<ul>
<li>A: For simplicity, we decided to use key name prefixes to store keys for each module across the entire application into one Azure Key Vault. This is an acceptable approach, but, if necessary, you may choose to separate the secrets for each module into a dedicated Azure Key Vault.</li>
</ul>
</li>
</ul>
<h2 id="signup-administration-user-flows">Signup Administration User Flows</h2>
<h3 id="sign-in">Sign In</h3>
<p>See the <a href="../identity/identity-flows#sign-in">Sign-In Flow</a> in Identity Flows.</p>
<h3 id="onboarding-flow">Onboarding Flow</h3>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">sequenceDiagram  
actor user as Tenant Admin
participant signup as Signup App
participant admin as Admin Api
participant auth as Auth Service
participant perm as Permissions Api
participant email as Email Logic App

user-&gt;&gt;signup: Sign Up Button Clicked

signup-&gt;&gt;signup: User Signed In/Token Exists?
signup--&gt;&gt;user: No, Redirect to /login
user-&gt;&gt;auth : Sign in or Sign Up
auth--&gt;&gt;user : JWT
user-&gt;&gt;signup: Sign Up Button Clicked
signup-&gt;&gt;signup: Token Exists?
signup-&gt;&gt;user : Yes, Start Onboarding Flow -- Org Name Page
user-&gt;&gt;signup: Org Name Provided
signup--&gt;&gt;user : Category Select
user-&gt;&gt;signup: Select Category
signup--&gt;&gt;user : Route Name Page
signup-&gt;&gt;user: Enter Route Name
signup-&gt;&gt;admin: Check if Route Exists
admin-&gt;&gt;signup: Route does not exist
signup--&gt;&gt;user : Validation Page
user-&gt;&gt;signup : Submit
signup-&gt;&gt;admin : Create Tenant
admin-&gt;&gt;admin : Create Tenant
admin-&gt;&gt;perm : Add Admin Permission for Tenant
perm--&gt;&gt;admin : Permission Added
admin-&gt;&gt;email : Send Tenant Created Confirmation Email
email--&gt;&gt;admin : Sent
admin--&gt;&gt;signup : Tenant Created
admin--&gt;&gt;user : Tenant Created Confirmation Page
</code></pre><h3 id="add-new-tenant-admin---existing-user">Add New Tenant Admin - Existing User</h3>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">sequenceDiagram
actor user as Tenant Admin
participant signup as SignupAdministration Site
participant admin as Admin API
participant perm as Permissions API
participant auth as Auth Service (B2C)

user-&gt;&gt;signup : Get list of tenants
signup-&gt;&gt;admin : Get list of tenants for user
admin--&gt;&gt;signup : List of tenants for user
signup--&gt;&gt;user : List of tenants
user-&gt;&gt;signup : Add user to tenant by email
signup-&gt;&gt;admin : POST: Add user to tenant by email
admin-&gt;&gt;admin : Claim({tenantId}.users.write)
admin-&gt;&gt;perm : Add user to tenant by email
perm-&gt;&gt;auth : User exists?
auth--&gt;&gt;perm : User exists
perm-&gt;&gt;perm : Add Permissions Record
perm--&gt;&gt;admin : Ok
admin--&gt;&gt;signup : Ok
signup--&gt;&gt;user : Ok
</code></pre><h3 id="add-new-tenant-admin---user-does-not-exist">Add New Tenant Admin - User Does Not Exist</h3>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">sequenceDiagram
actor user as Tenant Admin
participant signup as SignupAdministration Site
participant admin as Admin API
participant perm as Permissions API
participant auth as Auth Service (B2C)

user-&gt;&gt;signup : Get list of tenants
signup-&gt;&gt;admin : Get list of tenants for user
admin--&gt;&gt;signup : List of tenants for user
signup--&gt;&gt;user : List of tenants
user-&gt;&gt;signup : Add user to tenant by email
signup-&gt;&gt;admin : POST: Add user to tenant by email
admin-&gt;&gt;admin : Claim({tenantId}.users.write)
admin-&gt;&gt;perm : Add user to tenant by email
perm-&gt;&gt;auth : User exists?
auth--&gt;&gt;perm : User does not exist
perm--&gt;&gt;admin : Error, User does not exist
admin--&gt;&gt;signup : Error, User does not exist
signup--&gt;&gt;user : Error, User does not exist    
</code></pre>
	
	
	<div class="text-muted mt-5 pt-3 border-top">
  Last modified May 24, 2022: <a href="https://github.com/Azure/azure-saas/commit/f8c4b7d1bfeb3c5db6de9df3f95843aa5fb246ef">Fix anchor on signup-administration.md (f8c4b7d)</a>
</div>

</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/azure-saas/js/tabpane-persist.js'></script>


















<script src="/azure-saas/js/main.min.6cc4f2e68c1bae5b137f756ede53aa026afaae43271828491e233d4350630be1.js" integrity="sha256-bMTy5owbrlsTf3Vu3lOqAmr6rkMnGChJHiM9Q1BjC&#43;E=" crossorigin="anonymous"></script>




  </body>
</html>